// ╔╗╚╝║═╦╣╠╩╬▫

#define gotoxy(x,y) printf("\033[%d;%dH", (y), (x))

typedef struct{
    int x;
    int y;
    int point;
    char hidden;
} Food;

typedef struct{
    int x;
    int y;
} Intersection;

char map[31][200] = {
    "╔═════════════════════════╗ ╔═════════════════════════╗",
    "║                         ║ ║                         ║",
    "║   ╔═════╗   ╔═══════╗   ║ ║   ╔═══════╗   ╔═════╗   ║",
    "║   ║     ║   ║       ║   ║ ║   ║       ║   ║     ║   ║",
    "║   ╚═════╝   ╚═══════╝   ╚═╝   ╚═══════╝   ╚═════╝   ║",
    "║                                                     ║",
    "║   ╔═════╗   ╔═╗   ╔═════════════╗   ╔═╗   ╔═════╗   ║",
    "║   ╚═════╝   ║ ║   ╚═════╗ ╔═════╝   ║ ║   ╚═════╝   ║",
    "║             ║ ║         ║ ║         ║ ║             ║",
    "╚═════════╗   ║ ╚═════╗   ║ ║   ╔═════╝ ║   ╔═════════╝",
    "          ║   ║ ╔═════╝   ╚═╝   ╚═════╗ ║   ║          ",
    "          ║   ║ ║                     ║ ║   ║          ",
    "          ║   ║ ║   ╔═════════════╗   ║ ║   ║          ",
    "══════════╝   ╚═╝   ║             ║   ╚═╝   ╚══════════",
    "                    ║             ║                    ",
    "══════════╗   ╔═╗   ║             ║   ╔═╗   ╔══════════",
    "          ║   ║ ║   ╚═════════════╝   ║ ║   ║          ",
    "          ║   ║ ║                     ║ ║   ║          ",
    "          ║   ║ ║   ╔═════════════╗   ║ ║   ║          ",
    "╔═════════╝   ╚═╝   ╚═════╗ ╔═════╝   ╚═╝   ╚═════════╗",
    "║                         ║ ║                         ║",
    "║   ╔═════╗   ╔═══════╗   ║ ║   ╔═══════╗   ╔═════╗   ║",
    "║   ╚═══╗ ║   ╚═══════╝   ╚═╝   ╚═══════╝   ║ ╔═══╝   ║",
    "║       ║ ║                                 ║ ║       ║",
    "╚═══╗   ║ ║   ╔═╗   ╔═════════════╗   ╔═╗   ║ ║   ╔═══╝",
    "╔═══╝   ╚═╝   ║ ║   ╚═════╗ ╔═════╝   ║ ║   ╚═╝   ╚═══╗",
    "║             ║ ║         ║ ║         ║ ║             ║",
    "║   ╔═════════╝ ╚═════╗   ║ ║   ╔═════╝ ╚═════════╗   ║",
    "║   ╚═════════════════╝   ╚═╝   ╚═════════════════╝   ║",
    "║                                                     ║",
    "╚═════════════════════════════════════════════════════╝",
};

char foods[31][56] = {
    "                                                       ",
    "  . . . . . . . . . . . .     . . . . . . . . . . . .  ",
    "  .         .           .     .           .         .  ",
    "  0         .           .     .           .         0  ",
    "  .         .           .     .           .         .  ",
    "  . . . . . . . . . . . . . . . . . . . . . . . . . .  ",
    "  .         .     .                 .     .         .  ",
    "  .         .     .                 .     .         .  ",
    "  . . . . . .     . . . .     . . . .     . . . . . .  ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "            .                             .            ",
    "  . . . . . . . . . . . .     . . . . . . . . . . . .  ",
    "  .         .           .     .           .         .  ",
    "  .         .           .     .           .         .  ",
    "  0 . .     . . . . . . .     . . . . . . .     . . 0  ",
    "      .     .     .                 .     .     .      ",
    "      .     .     .                 .     .     .      ",
    "  . . . . . .     . . . .     . . . .     . . . . . .  ",
    "  .                     .     .                     .  ",
    "  .                     .     .                     .  ",
    "  . . . . . . . . . . . . . . . . . . . . . . . . . .  ",
    "                                                       ",
};

char walls[31][56] = {
    "########################### ###########################",
    "# i         i           i # # i           i         i #",
    "#   #######   #########   # #   #########   #######   #",
    "#   #     #   #       #   # #   #       #   #     #   #",
    "#   #######   #########   ###   #########   #######   #",
    "# i         i     i     i     i     i     i         i #",
    "#   #######   ###   ###############   ###   #######   #",
    "#   #######   # #   ####### #######   # #   #######   #",
    "# i         i # # i     i # # i     i # # i         i #",
    "###########   # #######   # #   ####### #   ###########",
    "          #   # #######   ###   ####### #   #          ",
    "          #   # # i     i     i     i # #   #          ",
    "          #   # #   ###############   # #   #          ",
    "###########   ###   #             #   ###   ###########",
    "            i     i #             # i     i            ",
    "###########   ###   #             #   ###   ###########",
    "          #   # #   ###############   # #   #          ",
    "          #   # # i                 i # #   #          ",
    "          #   # #   ###############   # #   #          ",
    "###########   ###   ####### #######   ###   ###########",
    "# i         i     i     i # # i     i     i         i #",
    "#   #######   #########   # #   #########   #######   #",
    "#   ##### #   #########   ###   #########   # #####   #",
    "# i   i # # i     i     i     i     i     i # # i   i #",
    "#####   # #   ###   ###############   ###   # #   #####",
    "#####   ###   # #   ####### #######   # #   ###   #####",
    "# i   i     i # # i     i # # i     i # # i     i   i #",
    "#   ########### #######   # #   ####### ###########   #",
    "#   ###################   ###   ###################   #",
    "# i                     i     i                     i #",
    "#######################################################",
};

Food f[244];
Intersection inter[64];

void renderMap()
{
    // render map
    printf("[1;34m");
    for(int y=0;y<31;y++){
        printf("%s\n",map[y]);
    }
    printf("[1;37m");
    gotoxy(27,13);
    printf("┈┈┈");

    // render food
    printf("[1;37m");
    int i = 0;
    for(int y=0;y<31;y++){
        for(int x=0;x<56;x++){
            char c = foods[y][x];
            if(c == '.'){
                gotoxy(x+1,y+1);
                printf("%s","▪");
                Food f_aux = {x,y,10,0};
                f[i++] = f_aux;
            }
            if(c == '0'){
                gotoxy(x+1,y+1);
                printf("%s","■");
                Food f_aux = {x,y,50,0};
                f[i++] = f_aux;
            }
        }
    }
    i = 0;
    for(int y=0;y<31;y++){
        for(int x=0;x<56;x++){
            char c = walls[y][x];
            if(c == 'i'){
                Intersection i_aux = {x,y};
                inter[i++] = i_aux;
            }
        }
    }
    //gotoxy(60,10);
    //printf("%d",i);

}

char isWall(int x, int y)
{
    if(walls[y][x] == '#'){
        return 1;
    }
    return 0;
}

int getPoint(int x, int y)
{
    for(int i =0;i<244;i++){
        Food * fs = &f[i];
        if(!fs->hidden && fs->x == x && fs->y == y){
            fs->hidden = 1;
            return fs->point;
        }
    }
    return 0;
}

char isIntersection(int x, int y)
{
    for(int i =0;i<64;i++){
        Intersection i_aux = inter[i];
        if(i_aux.x == x && i_aux.y == y){
            return 1;
        }
    }
    return 0;
};

char *getFoodPosition(int x, int y)
{
    for(int i =0;i<244;i++){
        Food fs = f[i];
        if(!fs.hidden && fs.x == x && fs.y == y){
            if(fs.point == 50){
                return "■";
            }
            return "▪";
        }
    }
    return " ";
}

char getHasFood()
{
    for(int i =0;i<244;i++){
        Food fs = f[i];
        if(!fs.hidden){
            return 1;
        }
    }
    return 0;
}
